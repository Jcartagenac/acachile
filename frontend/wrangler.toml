name = "acachile"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]
pages_build_output_dir = "dist"

# Bindings para Pages Functions
[[d1_databases]]
binding = "DB"
database_name = "acachile-db"
database_id = "086f0530-48b6-41db-95ab-77bce733f0df"

[[kv_namespaces]]
binding = "ACA_KV"
id = "4325e2596d6c455a8e90be44b3239ca4"
preview_id = "5390e4691c2c45d787ccd2a6d5383ea1"

# R2 bucket para im√°genes
[[r2_buckets]]
binding = "IMAGES"
bucket_name = "aca-chile-images"

# ‚ö†Ô∏è IMPORTANTE: Variables de Entorno
# Para cambiar el dominio en producci√≥n, actualiza estas variables en:
# Cloudflare Pages Dashboard ‚Üí Settings ‚Üí Environment variables
# 
# Las variables definidas aqu√≠ son para desarrollo local y tambi√©n se usan en producci√≥n
# a menos que sean sobrescritas en el Dashboard de Cloudflare Pages.
#
# Para variables sensibles (JWT_SECRET, API keys), usa Secrets en el Dashboard.
# Para variables p√∫blicas (URLs, dominios), puedes usar vars normales aqu√≠.
#
# Ver CLOUDFLARE_ENV_SETUP.md para instrucciones completas.
#
# üìß RESEND_API_KEY (REQUERIDO para notificaciones por email)
# Esta variable debe configurarse como Secret en Cloudflare Pages Dashboard:
# 1. Ve a: Cloudflare Pages ‚Üí acachile ‚Üí Settings ‚Üí Environment variables
# 2. Agrega variable: RESEND_API_KEY = re_xxxxxxxxxxxxxxxxxxxxx
# 3. M√°rcala como "Encrypted" (Secret)
# 4. Aplica para "Production" y "Preview"
# 5. Para obtener la API key: https://resend.com/api-keys
# 6. Configura el dominio de env√≠o en Resend (acachile.com o usa resend.dev para testing)

[env.production.vars]
ENVIRONMENT = "production"
CORS_ORIGIN = "https://acachile.com"
FRONTEND_URL = "https://acachile.com"
R2_PUBLIC_URL = "https://images.acachile.com"
FROM_EMAIL = "noreply@acachile.com"
ADMIN_EMAIL = "admin@acachile.cl"

# Variables para build de Vite (frontend)
VITE_API_BASE_URL = "https://acachile.com"
VITE_DOMAIN = "acachile.com"
VITE_R2_PUBLIC_URL = "https://images.acachile.com"
VITE_ENVIRONMENT = "production"

[env.preview.vars]
ENVIRONMENT = "preview"
CORS_ORIGIN = "*"
FRONTEND_URL = "https://acachile.com"
R2_PUBLIC_URL = "https://images.acachile.com"
FROM_EMAIL = "noreply@mail.juancartagena.cl"
ADMIN_EMAIL = "admin@acachile.cl"

# Variables para build de Vite (preview)
VITE_API_BASE_URL = "https://acachile.com"
VITE_DOMAIN = "acachile.com"
VITE_R2_PUBLIC_URL = "https://images.acachile.com"
VITE_ENVIRONMENT = "preview"

# Bindings espec√≠ficas para producci√≥n
[[env.production.kv_namespaces]]
binding = "ACA_KV"
id = "60fff9f10819406cad241e326950f056"

[[env.production.d1_databases]]
binding = "DB"
database_name = "acachile-db"
database_id = "086f0530-48b6-41db-95ab-77bce733f0df"

[[env.production.r2_buckets]]
binding = "IMAGES"
bucket_name = "aca-chile-images"

# Bindings espec√≠ficas para preview (mismos valores que producci√≥n)
[[env.preview.kv_namespaces]]
binding = "ACA_KV"
id = "60fff9f10819406cad241e326950f056"

[[env.preview.d1_databases]]
binding = "DB"
database_name = "acachile-db"
database_id = "086f0530-48b6-41db-95ab-77bce733f0df"

[[env.preview.r2_buckets]]
binding = "IMAGES"
bucket_name = "aca-chile-images"
