name = "acachile"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]
pages_build_output_dir = "dist"

# Bindings para Pages Functions
[[d1_databases]]
binding = "DB"
database_name = "acachile-db"
database_id = "2af4176e-ad62-4f85-a6d2-0bccef75fc66"

[[kv_namespaces]]
binding = "ACA_KV"
id = "4325e2596d6c455a8e90be44b3239ca4"
preview_id = "5390e4691c2c45d787ccd2a6d5383ea1"

# R2 bucket para imágenes
[[r2_buckets]]
binding = "IMAGES"
bucket_name = "aca-chile-images"

# ⚠️ IMPORTANTE: Variables de Entorno
# Para cambiar el dominio en producción, actualiza estas variables en:
# Cloudflare Pages Dashboard → Settings → Environment variables
# 
# Las variables definidas aquí son para desarrollo local y también se usan en producción
# a menos que sean sobrescritas en el Dashboard de Cloudflare Pages.
#
# Para variables sensibles (JWT_SECRET, API keys), usa Secrets en el Dashboard.
# Para variables públicas (URLs, dominios), puedes usar vars normales aquí.
#
# Ver CLOUDFLARE_ENV_SETUP.md para instrucciones completas.

[env.production.vars]
ENVIRONMENT = "production"
CORS_ORIGIN = "https://beta.acachile.com"
FRONTEND_URL = "https://beta.acachile.com"
R2_PUBLIC_URL = "https://images.beta.acachile.com"
FROM_EMAIL = "noreply@mail.juancartagena.cl"
ADMIN_EMAIL = "admin@acachile.cl"

# Variables para build de Vite (frontend)
VITE_API_BASE_URL = "https://beta.acachile.com"
VITE_DOMAIN = "beta.acachile.com"
VITE_R2_PUBLIC_URL = "https://images.beta.acachile.com"
VITE_ENVIRONMENT = "production"

[env.preview.vars]
ENVIRONMENT = "preview"
CORS_ORIGIN = "*"
FRONTEND_URL = "https://beta.acachile.com"
R2_PUBLIC_URL = "https://images.beta.acachile.com"
FROM_EMAIL = "noreply@mail.juancartagena.cl"
ADMIN_EMAIL = "admin@acachile.cl"

# Variables para build de Vite (preview)
VITE_API_BASE_URL = "https://beta.acachile.com"
VITE_DOMAIN = "beta.acachile.com"
VITE_R2_PUBLIC_URL = "https://images.beta.acachile.com"
VITE_ENVIRONMENT = "preview"

# Bindings específicas para producción
[[env.production.kv_namespaces]]
binding = "ACA_KV"
id = "60fff9f10819406cad241e326950f056"

[[env.production.d1_databases]]
binding = "DB"
database_name = "acachile-db"
database_id = "086f0530-48b6-41db-95ab-77bce733f0df"

[[env.production.r2_buckets]]
binding = "IMAGES"
bucket_name = "aca-chile-images"

# Bindings específicas para preview (mismos valores que producción)
[[env.preview.kv_namespaces]]
binding = "ACA_KV"
id = "60fff9f10819406cad241e326950f056"

[[env.preview.d1_databases]]
binding = "DB"
database_name = "acachile-db"
database_id = "086f0530-48b6-41db-95ab-77bce733f0df"

[[env.preview.r2_buckets]]
binding = "IMAGES"
bucket_name = "aca-chile-images"
